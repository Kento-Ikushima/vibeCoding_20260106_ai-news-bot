# AI技術ニュース通知Bot 要件定義書

## 1. プロジェクト概要

### 1.1 目的
毎朝8時（JST）に最新のAI技術情報を収集し、個人のLINEアカウントに通知するシステムを構築する。サーバーレス環境（GitHub Actions）で動作させる。

### 1.2 主な機能
- 指定されたウェブサイトからAI技術ニュースを自動収集
- 収集した記事の中から最も重要な1件を選択
- LINE経由で個人アカウントに通知送信
- 過去の通知履歴を記録し、重複通知を防止

## 2. 機能要件

### 2.1 ニュース収集機能

#### 2.1.1 対象サイト（優先順位順）
**日本語サイト（優先）：**
1. **AI-SCHOLAR** (https://ai-scholar.tech/)
   - AI研究論文の日本語解説
   - 新技術の詳細解説が充実

2. **AIZINE** (https://aizine.ai/)
   - AI業界の最新ニュース
   - 製品リリース情報

3. **ITmedia AI** (https://www.itmedia.co.jp/news/subtop/ai/)
   - ITmediaのAI関連記事
   - 業界動向

4. **日経XTECH AI** (https://xtech.nikkei.com/atcl/nxt/column/18/00001/)
   - 日経系の技術記事
   - 信頼性の高い情報源

5. **TechCrunch Japan AI** (https://jp.techcrunch.com/tag/ai/)
   - 海外AIニュースの日本語版
   - スタートアップ情報

6. **ZDNet Japan AI** (https://japan.zdnet.com/tag/ai/)
   - エンタープライズAI情報

**英語サイト（翻訳対応可能な場合）：**
- **arXiv** (最新AI論文の要約を取得し、日本語要約を生成)
- **Google AI Blog** (日本語対応記事を優先)

#### 2.1.2 収集対象記事の条件
- **必須キーワード（優先度高）：**
  - Vive Coding
  - 生成AI（Generative AI）
  
- **関連キーワード：**
  - 新しい言語モデル
  - レコーディングツール
  - 技術革新
  - AI技術の進歩
  - マルチモーダルAI
  - 音声AI
  - コード生成AI

- **除外条件：**
  - 明らかに古い記事（1週間以上前）
  - 広告記事
  - 重複記事（同一サイト内で同じ内容）

#### 2.1.3 記事選択ロジック
1. 収集した全記事から優先キーワード（Vive Coding、生成AI）を含む記事を抽出
2. 記事の公開日時が新しい順にソート
3. 過去に通知済みの記事を除外（後述の履歴管理参照）
4. 最も新しい記事1件を選択
5. 優先キーワードが含まれる記事がない場合、関連キーワードを含む記事から選択

### 2.2 LINE通知機能

#### 2.2.1 通知先
- 個人のLINEアカウント（LINE Messaging APIを使用）

#### 2.2.2 通知形式
**リッチテキスト形式（確定）**
```
📰 AI技術ニュース 【YYYY/MM/DD】

【タイトル】
記事のタイトル（最大100文字）

【要約】
記事の要約内容（300-500文字）
- 主要ポイント1
- 主要ポイント2
- 主要ポイント3

【タグ】
#生成AI #ViveCoding #言語モデル

【詳細リンク】
https://example.com/article

---
情報元: AI-SCHOLAR
公開日: YYYY年MM月DD日
```

**将来拡張（Phase 2）**
- 画像形式での通知（記事情報を画像として生成）
- LINEの画像メッセージとして送信

#### 2.2.3 通知要件
- **通知頻度**: 1日1回（毎朝8時JST）
- **通知件数**: 1記事のみ
- **読みやすさ**: スマートフォン画面で見やすく、スクロール不要で内容を把握できる形式
- **文字数制限**: テキスト形式の場合、1メッセージあたり最大1000文字程度

#### 2.2.4 要約生成
- **使用API**: Google Gemini Pro API（優先）、フォールバックとしてOpenAI API
- 記事本文から重要な情報を抽出
- 3-5個の箇条書きポイントを含める
- 技術的な専門用語は簡潔に説明
- 記事のリンクは必ず含める
- Gemini Pro APIが利用できない場合のみOpenAI APIを使用

### 2.3 重複防止機能

#### 2.3.1 履歴管理
- 通知済み記事のURLとタイトルを記録
- GitHubリポジトリ内のJSONファイルまたはCSVファイルで管理
- 以下の情報を記録：
  - URL（ユニークキー）
  - タイトル
  - 通知日時
  - 記事公開日時
  - サイト名

#### 2.3.2 重複判定ロジック
- 同じURLの記事は通知しない
- タイトルが完全一致する記事は30日以内は通知しない
- 同一記事が異なるサイトに掲載されている場合、最初に見つけたものを優先

#### 2.3.3 データクリーンアップ
- 30日以上前の履歴は自動的にアーカイブまたは削除
- 履歴ファイルのサイズが大きくなりすぎないように管理

### 2.4 エラーハンドリング

#### 2.4.1 想定されるエラーと対応
1. **ウェブサイトアクセスエラー**
   - 対応: 他のサイトから記事を取得を試みる
   - すべてのサイトでエラーの場合: エラーログを記録し、次の実行時にリトライ

2. **記事が見つからない場合**
   - 対応: 前回の通知済み記事から再度選択（重複チェックを緩和）
   - または、通知をスキップ（初日の場合は適当なメッセージを送信）

3. **LINE通知送信エラー**
   - 対応: エラーログを記録し、GitHub Actionsのログに出力
   - 次回実行時に再度通知を試みる仕組みは実装しない（1日1回の制約を維持）

4. **要約生成エラー**
   - 対応: タイトルとリンクのみで通知を送信

5. **データ保存エラー**
   - 対応: エラーログを記録し、次回実行時に再度保存を試みる

#### 2.4.2 ログ管理
- GitHub Actionsのワークフローログにエラー情報を記録
- 重要なエラーはGitHub Issuesとして自動作成（オプション）

## 3. 非機能要件

### 3.1 実行環境
- **プラットフォーム**: GitHub Actions
- **実行スケジュール**: 毎朝8時（JST）UTC時間で23:00（夏時間時は22:00）
- **実行時間**: 最大5分以内
- **実行頻度**: 1日1回

### 3.2 パフォーマンス要件
- 記事収集: 各サイトから最大1分以内に取得
- 要約生成: 1記事あたり30秒以内
- 全体処理時間: 5分以内

### 3.3 セキュリティ要件
- LINEアクセストークンはGitHub Secretsで管理
- Gemini Pro APIキーはGitHub Secretsで管理
- OpenAI APIキーはGitHub Secretsで管理（フォールバック用）
- ウェブサイトへのアクセスは適切なUser-Agentを設定
- レート制限を遵守（各サイトへの過度なアクセスを避ける）

### 3.4 拡張性
- 将来的にGoogle（その他のサービス）への通知機能を追加可能な設計
- 複数記事の通知に対応可能な設計
- 画像生成機能の追加に対応可能な設計

## 4. 技術スタック（想定）

### 4.1 実行環境
- **CI/CD**: GitHub Actions
- **言語**: Python 3.11以上

### 4.2 主要ライブラリ（想定）
- **Webスクレイピング**: BeautifulSoup4, requests, selenium（必要に応じて）
- **記事要約**: Google Gemini Pro API（優先）、フォールバックとしてOpenAI API
- **LINE通知**: requests（LINE Notify API使用）
- **データ管理**: JSON/CSVファイル操作
- **Gemini API**: google-generativeai
- **OpenAI API**: openai（フォールバック用）

### 4.3 データ保存
- GitHubリポジトリ内のJSONファイル
- 履歴管理用ファイル: `notified_articles.json` または `history.json`

## 5. データ構造

### 5.1 記事データ構造
```json
{
  "url": "https://example.com/article",
  "title": "記事タイトル",
  "summary": "記事要約",
  "published_date": "2024-01-05T00:00:00Z",
  "site_name": "AI-SCHOLAR",
  "tags": ["生成AI", "ViveCoding"],
  "keywords_matched": ["Vive Coding", "生成AI"]
}
```

### 5.2 通知履歴データ構造
```json
{
  "notified_articles": [
    {
      "url": "https://example.com/article",
      "title": "記事タイトル",
      "notified_at": "2024-01-05T08:00:00+09:00",
      "article_published_at": "2024-01-04T00:00:00Z",
      "site_name": "AI-SCHOLAR"
    }
  ],
  "last_updated": "2024-01-05T08:00:00+09:00"
}
```

## 6. ワークフロー設計

### 6.1 GitHub Actions ワークフロー概要
1. **スケジュール実行**: cron形式で毎朝8時JSTに実行
2. **環境セットアップ**: Python環境のセットアップ
3. **記事収集**: 各サイトから記事を収集
4. **記事選択**: 条件に合致する記事を1件選択
5. **重複チェック**: 通知履歴を確認
6. **要約生成**: 選択された記事の要約を生成
7. **LINE通知**: 通知を送信
8. **履歴更新**: 通知履歴を更新・保存
9. **コミット**: 履歴ファイルの変更をコミット

### 6.2 ディレクトリ構成（想定）
```
.
├── .github/
│   └── workflows/
│       └── daily-news.yml
├── src/
│   ├── scraper.py          # スクレイピング機能
│   ├── selector.py          # 記事選択ロジック
│   ├── summarizer.py        # 要約生成
│   ├── line_notifier.py     # LINE通知
│   └── history_manager.py   # 履歴管理
├── data/
│   └── notified_articles.json
├── requirements.txt
└── README.md
```

## 7. 制約事項

### 7.1 GitHub Actions の制約
- 無料プランでは月2000分の実行時間制限
- プライベートリポジトリでは月2000分
- パブリックリポジトリでは無制限

### 7.2 LINE Notifyの制約
- 通知頻度に制限あり（過度な通知は避ける）
- アクセストークンの管理が必要

### 7.3 スクレイピングの制約
- robots.txtの遵守
- 各サイトの利用規約の遵守
- 過度なアクセス負荷をかけない

## 8. 今後の拡張計画

### 8.1 Phase 2（将来）
- 画像形式での通知
- 複数記事の通知（ユーザー設定可能）
- Googleへの通知機能追加
- 他のプラットフォームへの通知（Slack、Discord等）

### 8.2 Phase 3（将来）
- ユーザー設定のカスタマイズ（キーワード、通知時間等）
- Web UIでの設定管理
- 通知履歴の閲覧機能

## 9. 成功指標

- 毎日8時に正常に実行される
- 通知が正常に送信される
- 重複記事が通知されない（同一記事が連日通知されない）
- エラー発生率が5%以下

## 10. 承認事項

### 10.1 承認が必要な事項
- [x] 対象サイトの選定（追加・削除）→ **確定済み**
- [x] 通知形式の最終決定（テキスト/画像）→ **テキスト形式で確定**
- [x] LINE Notify vs Messaging APIの選択→ **LINE Messaging APIで確定**
- [x] 要約生成方法の選択（API使用/ローカル処理）→ **Gemini Pro API（優先）、OpenAI API（フォールバック）で確定**

### 10.2 確認事項
- [x] GitHubリポジトリの作成（プライベート/パブリック）→ **パブリックリポジトリで確定**
- [ ] LINE Notify トークンの取得方法の確認
- [ ] Gemini Pro APIキーの取得方法の確認
- [ ] OpenAI APIキーの取得方法の確認（フォールバック用）
- [ ] 各サイトの利用規約の確認

---

**作成日**: 2025年1月5日  
**バージョン**: 1.0  
**次回レビュー**: 実装開始前

